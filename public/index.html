<!doctype html>
<html>
    <head>
        <meta charset='utf-8'>
        <!-- <link rel='author' href='authors.txt'> -->
        <meta name='author' content='Sergey Ryzhov'>
        <meta name='description' content='Graph strucutres and methods examples'>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <title>Graph strucutres and methods examples</title>

        <link rel='stylesheet' href='css/bootstrap.css'>
        <link rel='stylesheet' href='css/bootstrap-theme.css'>
        <script type='text/javascript' src='js/jquery-2.1.3.js'></script>
        <script type='text/javascript' src='js/bootstrap.js'></script>
        <script type='text/javascript' src='js/knockout-3.3.0.js'></script>
        <script type='text/javascript' src='js/knockout.mapping.js'></script>
        <script type='text/javascript' src='js/underscore.js'></script>

        <link rel='stylesheet' href='css/vis.min.css'>
        <script type='text/javascript' src='js/vis.min.js'></script>


        <script type='text/javascript' src='js/common/juggler.common.js'></script>
        <script type='text/javascript' src='js/graph/juggler.graph.view.js'></script>
    </head>
    <body>
      <div class='container'>
          <div class='row-fluid'>
            <div class='col-md-4'>
            <input type='text' data-bind='value:code'/>
            </div>
            <div data-bind='component: { name: "juggler-graph", params: { nodes: nodes, edges: edges }}' class='col-md-8'></div>
          </div>
      </div>

      <script type='text/javascript'>
        juggler.ready(function(j){
          console.info('Page loaded');
          // var nodes = [1, 2, 3, 4, 5],
          // edges = [
          //   [1, 2],
          //   [3, 4],
          //   [5, 2],
          //   [3, 5],
          //   [1, 4]
          // ];
          //j.graph.draw(document.querySelector('#graph'),nodes,edges);
        });
        function ParsePrufer(code){
            var n = code.length + 2,
                nodes = _.range(1, n+1),
                edges= [];
                count = _.range(1, n+1);
                without = _.range(1, n+1);

            for (var i = 0; i < code.length; i++) {
              without = _.without(without, code[i])
            }

            for (var i = 0; i < n -2; i++) {
              var from = without.shift(),
              to = code.shift();
              count = _.without(count,from);
              edges.push([from,to]);
            }
            edges.push(count);

            console.log(nodes);
            console.log(edges);
            return {
              nodes:nodes,
              edges:edges
              };
        }


        function Juggler(){

          this.code = ko.observable('[4, 4, 9, 4, 8, 3, 1]');
          this.prufer = ko.computed(function(){
            return ParsePrufer(JSON.parse(this.code()));
          }, this);

          this.nodes = ko.computed(function(){
            return this.prufer().nodes;
          }, this);

          this.edges = ko.computed(function(){
            return this.prufer().edges;
          }, this);
        }
        ko.applyBindings(new Juggler());
      </script>
    </body>
</html>
